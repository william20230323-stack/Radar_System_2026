name: V1_V2_Long_Range_Radar

on:
  schedule:
    - cron: '*/15 * * * *'  # æ¯15åˆ†é˜
  workflow_dispatch:        # æ‰‹å‹•è§¸ç™¼

jobs:
  radar-mission:
    runs-on: ubuntu-latest
    timeout-minutes: 12
    
    steps:
    - name: 1. æª¢å‡ºä»£ç¢¼
      uses: actions/checkout@v3

    - name: 2. åˆå§‹åŒ– Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    - name: 3. å®‰è£çµ„ä»¶
      run: pip install websocket-client requests

    - name: 4. ç™¼é€å•Ÿå‹•é€šçŸ¥
      env:
        TG_TOKEN: ${{ secrets.TG_TOKEN }}
        TG_CHAT_ID: ${{ secrets.TG_CHAT_ID }}
      run: |
        python3 -c "
        import requests, os
        token = os.getenv('TG_TOKEN')
        chat_id = os.getenv('TG_CHAT_ID')
        if token and chat_id:
            url = f'https://api.telegram.org/bot{token}/sendMessage'
            data = {'chat_id': chat_id, 'text': 'ğŸš€ V1/V2é›·é”å•Ÿå‹•æˆåŠŸ'}
            requests.post(url, json=data)
            print('âœ… Telegramé€šçŸ¥å·²ç™¼é€')
        else:
            print('âš ï¸ ç¼ºå°‘TG_TOKENæˆ–TG_CHAT_ID')
        "

    - name: 5. åŸ·è¡Œé›·é”ç³»çµ±
      env:
        TG_TOKEN: ${{ secrets.TG_TOKEN }}
        TG_CHAT_ID: ${{ secrets.TG_CHAT_ID }}
        TRADE_SYMBOL: ${{ secrets.TRADE_SYMBOL }}
      run: |
        echo "ğŸš€ é–‹å§‹åŸ·è¡Œé›·é”ç³»çµ±..."
        python3 -c "
        import time, os
        print('äº¤æ˜“å°:', os.getenv('TRADE_SYMBOL'))
        
        # æ¨¡æ“¬å·¥ä½œ
        for i in range(12):  # é‹è¡Œ12åˆ†é˜
            print(f'â³ é‹è¡Œä¸­... {i+1}åˆ†é˜')
            time.sleep(60)
        
        print('âœ… åŸ·è¡Œå®Œæˆ')
        "

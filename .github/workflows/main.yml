name: V1_V2_Long_Range_Radar

on:
  schedule:
    - cron: '*/15 * * * *'  # æ¯ 15 åˆ†é˜è‡ªå‹•é»ç«é‡å•Ÿ
  workflow_dispatch:        # æ‰‹å‹•é»ç«

jobs:
  radar-mission:
    runs-on: ubuntu-latest
    steps:
      - name: 1. æª¢å‡ºä»£ç¢¼
        uses: actions/checkout@v3

      - name: 2. åˆå§‹åŒ– Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: 3. å®‰è£çµ„ä»¶
        run: pip install websocket-client requests

      - name: 4. ç™¼é€å•Ÿå‹•é€šçŸ¥ï¼ˆæ–°å¢ï¼‰
        env:
          TG_TOKEN: ${{ secrets.TG_TOKEN }}
          TG_CHAT_ID: ${{ secrets.TG_CHAT_ID }}
        run: |
          # ä½¿ç”¨èˆ‡åŸç¨‹å¼ç›¸åŒçš„æ–¹å¼ç™¼é€é€šçŸ¥
          python -c "
          import requests
          import os
          token = os.getenv('TG_TOKEN')
          chat_id = os.getenv('TG_CHAT_ID')
          if token and chat_id:
              url = 'https://api.telegram.org/bot' + token + '/sendMessage'
              data = {'chat_id': chat_id, 'text': 'ğŸš€ V1/V2é›·é”ç³»çµ±å•Ÿå‹•æˆåŠŸï¼'}
              response = requests.post(url, data=data)
              print('é€šçŸ¥ç™¼é€ç‹€æ…‹ç¢¼:', response.status_code)
          "

      - name: 5. é»ç« V1/V2 å¯¦æ™‚é›·é”ï¼ˆåŸæ­¥é©Ÿ4ï¼‰
        env:
          TG_TOKEN: ${{ secrets.TG_TOKEN }}
          TG_CHAT_ID: ${{ secrets.TG_CHAT_ID }}
          TRADE_SYMBOL: ${{ secrets.TRADE_SYMBOL }}
        run: |
          # å°ˆæ³¨åŸ·è¡Œ V1/V2ï¼Œä¸åŸ·è¡Œ V3
          python radar_commander.py

name: V1_V2_Long_Range_Radar

on:
  schedule:
    - cron: '*/15 * * * *'  # æ¯ 15 åˆ†é˜
  workflow_dispatch:

jobs:
  radar-mission:
    runs-on: ubuntu-latest
    
    steps:
    - name: æª¢å‡ºä»£ç¢¼
      uses: actions/checkout@v3

    - name: è¨­ç½® Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'

    - name: å®‰è£ä¾è³´
      run: pip install websocket-client requests

    - name: åŸ·è¡Œé›·é”ç³»çµ±
      env:
        TG_TOKEN: ${{ secrets.TG_TOKEN }}
        TG_CHAT_ID: ${{ secrets.TG_CHAT_ID }}
        TRADE_SYMBOL: ${{ secrets.TRADE_SYMBOL }}
      run: |
        # ç™¼é€å•Ÿå‹•é€šçŸ¥ï¼ˆç°¡å–®å¯é ï¼‰
        python -c "
        import requests, os
        token = os.getenv('TG_TOKEN')
        chat_id = os.getenv('TG_CHAT_ID')
        if token and chat_id:
            url = f'https://api.telegram.org/bot{token}/sendMessage'
            data = {'chat_id': chat_id, 'text': 'ğŸš€ V1/V2é›·é”å•Ÿå‹•æˆåŠŸ'}
            response = requests.post(url, json=data)
            print(f'é€šçŸ¥ç‹€æ…‹: {response.status_code}')
        "
        
        # åŸ·è¡ŒåŸæœ‰é›·é”ç¨‹å¼
        echo "é–‹å§‹åŸ·è¡Œ radar_commander.py..."
        python radar_commander.py
